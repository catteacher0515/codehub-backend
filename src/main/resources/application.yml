server:
  port: 8125
  servlet:
    context-path: /api  # 建议加上统一前缀，这样所有接口都会变成 /api/xxx，方便区分

spring:
  application:
    name: codehub-next

  # =======================================================
  # 1. 数据库配置 (PostgreSQL + PGVector)
  # 注意：如果不使用 RAG (向量检索) 功能，这部分可以先注释掉，否则启动会报错连接不上数据库
  # =======================================================
  #  datasource:
  #    driver-class-name: org.postgresql.Driver
  #    url: jdbc:postgresql://localhost:5432/codehub_vector
  #    username: postgres
  #    password: password

  # =======================================================
  # 2. Spring AI 配置 (阿里云百炼 DashScope)
  # =======================================================
  ai:
    dashscope:
      api-key: ${CODEHUB_DASH_SCOPE_KEY} # 读取环境变量，安全第一
      chat:
        options:
          model: qwen-plus # 推荐使用 qwen-plus 或 qwen-max
      # 如果暂时还没装好向量数据库，建议把 embedding 和 vectorstore 先设为 false 或注释掉
      embedding:
        enabled: true

    vectorstore:
      pgvector:
        initialize-schema: true
        dimensions: 1536 # qwen-text-embedding-v1 的维度通常是 1536
        index-type: HNSW
        distance-type: COSINE_DISTANCE

  # =======================================================
  # 3. 辅助功能配置
  # =======================================================
  jackson:
    date-format: yyyy-MM-dd HH:mm:ss
    time-zone: GMT+8

# =======================================================
# 4. Knife4j 接口文档配置
# =======================================================
springdoc:
  swagger-ui:
    path: /swagger-ui.html
    tags-sorter: alpha
    operations-sorter: alpha
  api-docs:
    path: /v3/api-docs
  group-configs:
    - group: 'default'
      paths-to-match: '/**'
      packages-to-scan: com.pingyu.codehub.backend.controller

knife4j:
  enable: true
  setting:
    language: zh_cn

# =======================================================
# 5. 日志配置 (侦探的放大镜)
# =======================================================
#logging:
#  level:
#    root: INFO                             # 根级别保持 INFO，避免刷屏
#    com.pingyu.codehubbackend: DEBUG       # 你的项目包名，开启 DEBUG 以观察自己的 Bean
#    org.springframework.ai: DEBUG          # 重点：开启 Spring AI 的调试日志
#    org.springframework.beans: DEBUG       # 重点：观察 Bean 的依赖注入和创建顺序
#    org.springframework.web: INFO